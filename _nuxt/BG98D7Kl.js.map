{"version":3,"file":"BG98D7Kl.js","sources":["../../../../../../packages/core/components/layout/v-menu/v-menu-item.vue","../../../../../../packages/core/components/layout/v-menu/v-menu-group.vue","../../../../../../packages/core/components/layout/v-menu/v-menu.vue","../../../../components/v-modal/v-modal-sign-agreement.vue","../../../../components/layout/v-static-notifications.vue","../../../../layouts/default.vue"],"sourcesContent":["<template>\n  <div class=\"px-4\">\n    <nuxt-link\n      :to=\"props.to\"\n      class=\"block rounded-md px-3 py-1 text-gray-700 transition-all dark:text-gray-400\"\n      :class=\"{\n        '!cursor-not-allowed opacity-30': props.disabled,\n        'hover:bg-gray-200 hover:dark:bg-gray-800': !props.disabled,\n        '!bg-gray-300 dark:!bg-gray-700': isActive,\n      }\"\n      @click.capture=\"onClick\"\n    >\n      <slot />\n    </nuxt-link>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nconst props = defineProps<{\n  to: string\n  disabled?: boolean\n}>()\n\nconst route = useRoute()\nconst isActive = computed(() => {\n  if (props.to === \"/\") {\n    return route.path === props.to\n  }\n\n  return route.path.startsWith(props.to)\n})\n\nfunction onClick(e: MouseEvent) {\n  if (props.disabled) {\n    e.stopPropagation()\n    e.preventDefault()\n  }\n}\n</script>\n","<template>\n  <div>\n    <div class=\"mb-1.5 px-5 text-lg font-medium\">{{ props.title }}</div>\n    <div class=\"flex flex-col items-stretch gap-1\">\n      <slot />\n    </div>\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nconst props = defineProps<{\n  title: string\n}>()\n</script>\n","<template>\n  <nav class=\"sticky top-3 flex h-fit flex-col items-stretch gap-3 rounded-md bg-gray-100 py-4 transition dark:bg-slate-900\">\n    <slot />\n  </nav>\n</template>\n\n<script setup lang=\"ts\"></script>\n","<template>\n  <v-modal\n    ref=\"modal\"\n    v-model=\"isVisible\"\n    size=\"w-[85rem]\"\n  >\n    <template #header> {{ props.agreement.name }} </template>\n\n    <iframe\n      :src=\"props.agreement.uri\"\n      class=\"mb-5 aspect-[9/16] w-full\"\n    />\n\n    <form class=\"grid grid-cols-3 gap-5\">\n      <v-label label=\"Name\">\n        <v-input v-model=\"form.signatory_name\" />\n      </v-label>\n\n      <v-label label=\"6 digit code from your authenticator app\">\n        <v-input v-model=\"form['2fa_code']\" />\n      </v-label>\n\n      <v-label label=\"Date\">\n        <v-input\n          :model-value=\"new Date().toLocaleDateString()\"\n          disabled\n        />\n      </v-label>\n    </form>\n\n    <template #footer>\n      <v-button\n        variant=\"primary\"\n        :loading=\"isSubmitting\"\n        @click=\"submit\"\n      >\n        Sign\n      </v-button>\n    </template>\n  </v-modal>\n</template>\n\n<script setup lang=\"ts\">\nimport { VModal } from \"#components\"\nimport type { Agreement, Payload } from \"core/types/api\"\n\nconst props = defineProps<{\n  agreement: Agreement\n}>()\n\nconst modal = ref<InstanceType<typeof VModal>>()\nconst isVisible = ref(false)\n\ndefineExpose({\n  show: () => modal.value?.show(),\n  hide: () => modal.value?.hide(),\n})\n\nconst form = reactive<Payload<typeof signAgreement>>({\n  id: props.agreement.id,\n  signatory_name: \"\",\n  \"2fa_code\": \"\",\n})\nwatchEffect(() => {\n  form.id = props.agreement.id\n})\nwatchEffect(() => {\n  if (!isVisible.value) {\n    form.signatory_name = \"\"\n    form[\"2fa_code\"] = \"\"\n  }\n})\n\nconst agreementsStore = useAgreementsStore()\n\nconst isSubmitting = ref(false)\nasync function submit() {\n  if (isSubmitting.value) {\n    return\n  }\n\n  isSubmitting.value = true\n  try {\n    await signAgreement(form)\n    await agreementsStore.load()\n\n    isVisible.value = false\n    form.signatory_name = \"\"\n    form[\"2fa_code\"] = \"\"\n\n    const { notifySuccess } = useNotification()\n    notifySuccess(\"Agreement was signed\")\n\n    const emitter = useEmitter()\n    emitter.emit(\"agreementSigned\", props.agreement)\n  } finally {\n    isSubmitting.value = false\n  }\n}\n</script>\n","<template>\n  <div\n    v-if=\"unsignedAgreements.length\"\n    class=\"mb-5 flex flex-col gap-2\"\n  >\n    <v-notification\n      v-for=\"agreement of unsignedAgreements\"\n      :key=\"agreement.id\"\n      type=\"warning\"\n      class=\"cursor-pointer\"\n      @click=\"openAgreementModal(agreement)\"\n    >\n      Required agreement <b>«{{ agreement.name }}»</b> isn't signed.\n    </v-notification>\n\n    <v-modal-sign-agreement\n      v-if=\"activeAgreement\"\n      ref=\"agreementModal\"\n      :agreement=\"activeAgreement\"\n    />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nimport type { Agreement } from \"core/types/api\"\nimport { VModalSignAgreement } from \"#components\"\n\nconst { unsignedAgreements } = storeToRefs(useAgreementsStore())\n\nconst agreementModal = ref<InstanceType<typeof VModalSignAgreement>>()\nconst activeAgreement = ref<null | Agreement>(null)\nasync function openAgreementModal(agreement: Agreement) {\n  activeAgreement.value = agreement\n  await nextTick()\n  agreementModal.value?.show()\n}\n</script>\n","<template>\n  <div class=\"flex h-full flex-col\">\n    <v-header>\n      <template v-if=\"route.name !== 'auth'\">\n        <template v-if=\"userStore.data\">\n          <span>{{ userStore.data.email }}</span>\n          <v-button\n            variant=\"primary\"\n            @click=\"userStore.logout\"\n          >\n            Logout\n          </v-button>\n        </template>\n        <v-button\n          v-else\n          variant=\"primary\"\n          to=\"/auth\"\n        >\n          Login\n        </v-button>\n      </template>\n    </v-header>\n\n    <v-container class=\"flex flex-grow gap-8\">\n      <v-menu class=\"shrink-0 basis-[18rem]\">\n        <v-menu-group title=\"Apps\">\n          <v-menu-item to=\"/apps/identifiers\">Identifiers</v-menu-item>\n          <v-menu-item to=\"/apps/binary-packages\">IPA packages</v-menu-item>\n        </v-menu-group>\n        <v-menu-group title=\"Financial\">\n          <v-menu-item\n            to=\"/finances/invoices\"\n            disabled\n          >\n            Invoices\n          </v-menu-item>\n          <v-menu-item\n            to=\"/finances/payouts\"\n            disabled\n          >\n            Payouts\n          </v-menu-item>\n          <v-menu-item\n            to=\"/finances/revenue\"\n            disabled\n          >\n            Revenue\n          </v-menu-item>\n          <v-menu-item\n            to=\"/finances/products\"\n            disabled\n          >\n            Products\n          </v-menu-item>\n        </v-menu-group>\n        <v-menu-group title=\"Legal\">\n          <v-menu-item to=\"/legal/overview\">Overview</v-menu-item>\n          <v-menu-item to=\"/legal/features\">Platform features</v-menu-item>\n          <v-menu-item to=\"/legal/copyright-infringements\">Copyright infringements</v-menu-item>\n          <v-menu-item to=\"https://publisherid.appdb.to\">Publisher ID</v-menu-item>\n        </v-menu-group>\n        <v-menu-group title=\"Developer area\">\n          <v-menu-item to=\"/developer/tokens\">Service keys & tokens</v-menu-item>\n          <v-menu-item to=\"/developer/test-devices\">Test devices</v-menu-item>\n          <v-menu-item to=\"https://rtfm.dbservices.to/\">Documentation</v-menu-item>\n        </v-menu-group>\n        <v-menu-group title=\"Settings\">\n          <v-menu-item\n            to=\"/settings/notifications\"\n            disabled\n          >\n            Email notifications\n          </v-menu-item>\n\n          <v-menu-item\n            to=\"/developer/events-notifications\"\n            disabled\n          >\n            Events notifications\n          </v-menu-item>\n        </v-menu-group>\n      </v-menu>\n\n      <main class=\"flex-grow\">\n        <v-static-notifications />\n        <slot />\n      </main>\n    </v-container>\n    <v-footer />\n  </div>\n</template>\n\n<script setup lang=\"ts\">\nconst route = useRoute()\n\nconst userStore = useUserStore()\n</script>\n"],"names":["props","__props","route","useRoute","isActive","computed","onClick","e","_sfc_render","_ctx","_cache","_openBlock","_createElementBlock","_hoisted_1","modal","ref","isVisible","__expose","_a","form","reactive","watchEffect","agreementsStore","useAgreementsStore","isSubmitting","submit","signAgreement","notifySuccess","useNotification","useEmitter","unsignedAgreements","storeToRefs","agreementModal","activeAgreement","openAgreementModal","agreement","nextTick","userStore","useUserStore"],"mappings":"+lBAkBA,MAAMA,EAAQC,EAKRC,EAAQC,IACRC,EAAWC,EAAS,IACpBL,EAAM,KAAO,IACRE,EAAM,OAASF,EAAM,GAGvBE,EAAM,KAAK,WAAWF,EAAM,EAAE,CACtC,EAED,SAASM,EAAQC,EAAe,CAC1BP,EAAM,WACRO,EAAE,gBAAgB,EAClBA,EAAE,eAAe,EAErB,wgBC3BA,MAAMP,EAAQC,sOCTZ,SAAAO,GAAAC,EAAAC,EAAA,QACUC,EAAA,EAAAC,EAAA,MAAAC,GAAA,sLC4CZ,MAAMb,EAAQC,EAIRa,EAAQC,IACRC,EAAYD,EAAI,EAAK,EAEdE,EAAA,CACX,KAAM,IAAM,OAAA,OAAAC,EAAAJ,EAAM,QAAN,YAAAI,EAAa,QACzB,KAAM,IAAM,OAAA,OAAAA,EAAAJ,EAAM,QAAN,YAAAI,EAAa,OAAK,CAC/B,EAED,MAAMC,EAAOC,EAAwC,CACnD,GAAIpB,EAAM,UAAU,GACpB,eAAgB,GAChB,WAAY,EAAA,CACb,EACDqB,EAAY,IAAM,CACXF,EAAA,GAAKnB,EAAM,UAAU,EAAA,CAC3B,EACDqB,EAAY,IAAM,CACXL,EAAU,QACbG,EAAK,eAAiB,GACtBA,EAAK,UAAU,EAAI,GACrB,CACD,EAED,MAAMG,EAAkBC,IAElBC,EAAeT,EAAI,EAAK,EAC9B,eAAeU,GAAS,CACtB,GAAI,CAAAD,EAAa,MAIjB,CAAAA,EAAa,MAAQ,GACjB,GAAA,CACF,MAAME,EAAcP,CAAI,EACxB,MAAMG,EAAgB,OAEtBN,EAAU,MAAQ,GAClBG,EAAK,eAAiB,GACtBA,EAAK,UAAU,EAAI,GAEb,KAAA,CAAE,cAAAQ,GAAkBC,IAC1BD,EAAc,sBAAsB,EAEpBE,IACR,KAAK,kBAAmB7B,EAAM,SAAS,CAAA,QAC/C,CACAwB,EAAa,MAAQ,EACvB,EACF,4gCCvEA,KAAM,CAAE,mBAAAM,CAAuB,EAAAC,EAAYR,EAAoB,CAAA,EAEzDS,EAAiBjB,IACjBkB,EAAkBlB,EAAsB,IAAI,EAClD,eAAemB,EAAmBC,EAAsB,OACtDF,EAAgB,MAAQE,EACxB,MAAMC,EAAS,GACflB,EAAAc,EAAe,QAAf,MAAAd,EAAsB,MACxB,kfC0DA,MAAMhB,EAAQC,IAERkC,EAAYC"}